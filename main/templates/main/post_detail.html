{% extends "main/base.html" %}
{% block content %}
<article class="media content-section">
    <img class="rounded-circle article-img" src="{{ post.author.image.url }}">
    <div class="media-body">
        <div class="article-metadata">
            {% if user.is_authenticated %}
            <a class="mr-2" href="{% url 'profile' post.author.user.id %}">{{ post.author }}</a>
            {% else %}
            <h5>{{ post.author }}</h5>
            {% endif %}
            <small class="text-muted">{{ post.date_posted }}</small>
            {% if post.author == user.profile or user.is_superuser%}
            <div>
                <a class='btn btn-danger btn-sm mt-1 mb-1' style="float: right;"
                   href="{% url 'post-delete' post.id %}">Delete Post</a>
            </div>
            {% endif %}
        </div>
        <h4 class="article-title">{{ post.title }}</h4>
        <p class="article-content">{{ post.description }}</p>
        <audio controls>
            <source src="{{ post.song.url }}" type="audio/mp3">
            Your browser does not support the audio element.
        </audio>
    </div>
</article>

<div>
    <a class="btn btn-default" href="{% url 'add_comment_to_post' pk=post.pk %}">Add comment</a>

    {% if post.comments.count == 0 %}

    <p>No comments</p>

    {% else %}

    {% for comment in post.comments.all %}
    <article class="media content-section">
        <p>{{ comment }}</p>
    </article>
    {% endfor %}

    {% endif %}
</div>

<!--{% if post.comments.count == 0 %}-->

<!--<div>-->
<!--<p><h5>No comments yet</h5></p>-->
<!--<form method="GET">-->
<!--Leave a comment <input type="text" name="comment"><br/>-->
<!--<input type="submit" value="Submit"/>-->
<!--</form>-->
<!--<br/><br/>-->

<!--{% for comment in post.comments.all %}-->
<!--<p>{{comment}}</p>-->
<!--{% endfor %}-->
<!--</div>-->

<!--{% else %}-->

<!--<div>-->
<!--{% for comment in post.comments.all %}-->
<!--<p>{{comment}}</p>-->
<!--{% endfor %}-->

<!--{% if user.is_authenticated %}-->
<!--{% for comment in post.comments.all %}-->
<!--<p>{{comment}}</p>-->
<!--{% endfor %}-->
<!--{% endif %}-->
<!--</div>-->

<!--{% endif %}-->

{% endblock content %}
